# üìò Project Cloud.ru QA/AI Subproject

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–¥—É–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤ (UI/API/E2E) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (Apps) –∏ –æ–±—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (Libs).

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –∫–æ–Ω–µ—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

### `apps/` ‚Äî –ö–æ–Ω–µ—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
–°–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞.
* **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:** API Endpoints.
* **–°–µ—Ä–≤–∏—Å—ã:** –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
* **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:** –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.

### `libs/` ‚Äî –û–±—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
–ü–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

| –ö–∞—Ç–∞–ª–æ–≥ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| :--- | :--- |
| `libs/shared` | –£—Ç–∏–ª–∏—Ç—ã, –æ–±—â–∏–µ —Ç–∏–ø—ã, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã. |
| `libs/agents` | –õ–æ–≥–∏–∫–∞ AI-–∞–≥–µ–Ω—Ç–æ–≤, –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∞–≤—Ç–æ-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤. |
| `libs/integrations` | –ö–ª–∏–µ–Ω—Ç—ã –≤–Ω–µ—à–Ω–∏—Ö API (–±–µ–∑ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏). |
| `libs/systems` | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º. |
| `libs/infractract` | –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π (ORM, S3/GCS –¥—Ä–∞–π–≤–µ—Ä—ã). |

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
* **envs/** ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Dev/Staging/Prod.
* **deploy/** ‚Äî Docker, docker-compose —Ñ–∞–π–ª—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

---

## AI-–ø–æ–¥–ø—Ä–æ–µ–∫—Ç: Workflow

**–¶–µ–ª—å:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ –∏—Ö –≤–∞–ª–∏–¥–∞—Ü–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∂–∏–º—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

| Mode | –§–æ—Ä–º–∞—Ç | –û–ø–∏—Å–∞–Ω–∏–µ / –ö—Ä–∏—Ç–µ—Ä–∏–∏ |
| :--- | :--- | :--- |
| `manual_ui` | Markdown (`.md`) | UI –∫–µ–π—Å—ã (‚â•15 —à—Ç). –ü–æ–ª—è: ID, Title, Preconditions, Steps, Expected. |
| `manual_api` | Markdown (`.md`) | API –∫–µ–π—Å—ã (‚â•15 —à—Ç). –°—É—â–Ω–æ—Å—Ç–∏: VMs, Disks, Flavors. |
| `e2e` | Python (`e2e.py`) | Playwright + pytest. –ú–∏–Ω–∏–º—É–º 5 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. |
| `api_tests` | Python (`api_tests.py`) | httpx/requests. –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ/–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∫–µ–π—Å—ã (‚â•8‚Äì10 —Ç–µ—Å—Ç–æ–≤). |

---

# –ó–∞–ø—É—Å–∫ –∏ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

! –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ —É–¥–æ–±—Å—Ç–≤–∞ –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–∏–Ω–¥—ã (–Ω–µ –∑–∞–±—É–¥—å—Ç–µ –≤–∫–ª—é—á–∏—Ç—å –¥–æ–∫–µ—Ä!)
(–≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –∏ –Ω–µ —Ä–∞–±–æ—á–∏—Ö cmd - –≤–∫–ª—é—á–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é –ø–æ –ø–æ—Ä—è–¥–∫—É)

    –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!):
        1. setup_env.cmd       # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        2. check_system.cmd    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
        3. start_server.cmd    # –ó–∞–ø—É—Å–∫ NATS –∏ Worker
    –í –Ω–æ–≤–æ–º –æ–∫–Ω–µ:
        run_task.cmd        # –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

# 1. –°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å venv (–≤ qik-test-qa-server\ai)
python -m venv .venv
.venv\Scripts\Activate.ps1

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (PowerShell):
$env:NATS_URL="nats://localhost:4222"
$env:USE_REAL_LLM="true"
$env:LLM_API_KEY="<qwen_api_key>"           (–≤–∞—à api –∫–ª—é—á)
$env:LLM_BASE_URL="[https://foundation-models.api.cloud.ru/v1/chat/completions](https://foundation-models.api.cloud.ru/v1/chat/completions)"
$env:LLM_MODEL="Qwen/Qwen3-Coder-480B-A35B-Instruct"
$env:GITHUB_PAT="<token_with_repo_rights>"          (–≤–∞—à –≥–∏—Ç—Ö–∞–± —Ç–æ–∫–µ–Ω)

# –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose
(–ø–µ—Ä–µ—Ö–æ–¥–∏–º)
docker compose -f deploy/compose.proxy.yml up -d nats

# –í–∞—Ä–∏–∞–Ω—Ç 2: Docker run
docker run --rm -p 4222:4222 -p 8222:8222 nats:latest -DV (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è. –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ server —Ä–µ–ø–æ)

(—Å–æ–∑–¥–∞–µ—Ç–µ –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ server/ai, –≤—Ö–æ–¥–∏—Ç–µ –≤ env)
$env:PYTHONPATH="ai;ai\apps\worker\src"
python -m apps.worker.src.ai_worker.nats_worker (–∏–∑ server —Ä–µ–ø–æ)



–ø—Ä–∏–º–µ—Ä—ã Payload(NATS)

–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–¥–∞—á–∏ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è manual_ui):
{
  "request_id": "req-ui-1",
  "spec": {},
  "mode": "manual_ui",
  "context": {
    "ui_notes": "—Å–º. case_detail.md, –±–ª–æ–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞"
  },
  "callback_subject": "ai.responses.ui"
}

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ PR —Å —Ç–µ—Å—Ç–∞–º–∏:
{
  "request_id": "cicd-xxxx",
  "run_id": "<run_id_from_generate>",
  "repo": "[https://github.com/owner/repo.git](https://github.com/owner/repo.git)",
  "branch": "ai/generated/<run_id>",
  "target_branch": "main",
  "commit_message": "Add AI generated tests",
  "create_pr": true,
  "dry_run": true,
  "callback_subject": "ai.responses.cicd"
}

src/
  ‚îú‚îÄ app/        # –†–æ—É—Ç–∏–Ω–≥, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  ‚îú‚îÄ widgets/    # –ö—Ä—É–ø–Ω—ã–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ UI —Å –ª–æ–≥–∏–∫–æ–π
  ‚îú‚îÄ features/   # –û—Ç–¥–µ–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü–∏–∏
  ‚îú‚îÄ entities/   # –ë–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏ (Model)
  ‚îî‚îÄ shared/     # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥
       ‚îú‚îÄ api/   # –ë–∞–∑–æ–≤—ã–µ API –∫–ª–∏–µ–Ω—Ç—ã
       ‚îú‚îÄ types/ # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã
       ‚îú‚îÄ ui/    # UI Kit (–∫–Ω–æ–ø–∫–∏, –∏–Ω–ø—É—Ç—ã)
       ‚îî‚îÄ libs/  # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–ø–æ–¥—Ä–æ–±–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∫–µ–Ω–¥ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–π –≤ qik-test-qa-server/ai/structure.md
